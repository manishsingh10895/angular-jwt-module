var app=angular.module("angular-jwt",["ngStorage"]);app.config(function(t,e){t.interceptors.push(function(t,e){return{request:function(t){return t.headers=t.headers||{},console.log(e.token),e.token&&(t.headers.Authorization="Bearer "+e.token),t},responseError:function(e){return 401==e.status||400==e.status,t.reject(e)}}})}),app.service("jwtAuthService",function(t,e,n,i){function o(t){var e=t.replace("-","+").replace("_","/");switch(e.length%4){case 0:break;case 2:e+="==";break;case 3:e+="=";break;default:throw"Illegal base64url string!"}return window.atob(e)}function s(t){var e=t.split(" ");if(3!==e.length)throw new Error("Token is invalid, A valid token has three parts");var n=o(e[1]);if(!n)throw new Error("Token not decoded");return JSON.parse(n)}function r(){var t=e.token,n={};if("undefined"!=typeof t){var n=s(t);return n}}this.login=function(o,s,r){console.log(t.baseApiUrl),i.post(t.baseApiUrl+t.signinRoute,o).then(function(t){s?(e.token=t.data.token,s(t)):(e.token=t.data.token,n.go("home"))},function(t){r&&r(t)})},this.getTokenClaims=r(),this.signup=function(o,s,r){i.post(t.baseApiUrl+t.signupRoute,o).then(function(t){s?(e.token=t.data.token,console.log(e.token),s(t)):(e.token=t.data.token,n.go("home"))},function(t){r&&r(t)})}}),app.provider("jwtAuth",function(){this.baseUrl="/api",this.homeState="home",this.loginState="login",this.signupState="signup",this.signinState="signin",self=this,this.setBaseUrl=function(t){this.baseUrl=t},this.setBaseApiUrl=function(t){this.baseApiUrl=t},this.getProperty=function(t){return this[t]},this.initializeAuthservice=function(t){self.baseApiUrl=t.baseApiUrl,self.signinState=t.signinState,self.loginState=t.loginState,self.homeState=t.homeState,self.signupState=t.signupState},this.$get=function(){return self}});